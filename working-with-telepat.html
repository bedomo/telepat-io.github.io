<!DOCTYPE html><!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8 ie7"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9 ie8"> <![endif]-->
<!--[if IE 9]>         <html class="no-js ie9"> <![endif]-->
<!--[if gt IE 9]>      <html class="no-js gt-ie9"> <![endif]-->
<!--[if !IE]> <![IGNORE[--><!--[IGNORE[]]--> <html class="no-js noie">
<head>
  <meta charset="utf-8">
  <title>Telepat Docs</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="images/favicon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/favicon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/favicon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/favicon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="images/favicon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/favicon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="images/favicon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/favicon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="images/favicon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="images/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="images/favicon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="images/favicon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="images/favicon/favicon-128.png" sizes="128x128">
  <meta name="application-name" content="Telepat">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-TileImage" content="images/favicon/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="images/favicon/mstile-70x70.png">
  <meta name="msapplication-square150x150logo" content="images/favicon/mstile-150x150.png">
  <meta name="msapplication-wide310x150logo" content="images/favicon/mstile-310x150.png">
  <meta name="msapplication-square310x310logo" content="images/favicon/mstile-310x310.png">
  <link rel="stylesheet" href="styles/main.css">
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet" type="text/css">
</head>
<body><img id="to-top" src="images/up-arrow-icon.png" onClick="window.scrollTo(0, 0);">
  <div id="top-menu">
    <div class="pull-left"><span onClick="$('#wrapper').toggleClass('toggled')" class="glyphicon glyphicon-list"></span></div>
    <div class="pull-right">Telepat.io Docs</div>
    <div class="clear"></div>
  </div>
  <div id="wrapper">
    <div id="sidebar-wrapper"><a href="http://telepat.io" title="Telepat Real-Time Backend">
        <div data-height="70" data-stroke-color="#000000" class="telepat-logo"></div></a>
      <script type="text/javascript" src="http://telepat.io/scripts/telepat-logo.js"></script>
      <ul class="sidebar-nav first">
        <li><a id="alpha-menu" href="/" class="alpha">Introduction</a></li>
        <li><a id="beta-menu" href="/getting-started.html" class="beta">Getting Started</a></li>
        <li><a id="gamma-menu" href="/roadmap.html" class="gamma">Roadmap</a></li>
        <li><a id="delta-menu" href="/api-docs.html" class="delta">API Reference</a></li>
        <li><a id="epsilon-menu" href="/js-sdk.html" class="epsilon">JS Client Reference</a></li>
        <li><a id="zeta-menu" href="/android-sdk.html" class="zeta">Android Client Reference</a></li>
        <li><a id="eta-menu" href="/ios-sdk.html" class="eta">iOS Client Reference</a></li>
        <div id="github-fork-badge">Improve the docs
          <iframe src="https://ghbtns.com/github-btn.html?user=telepat-io&amp;repo=telepat-io.github.io&amp;type=fork&amp;count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
        </div>
      </ul>
    </div>
    <div id="page-content-wrapper">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-12">
            <div style="margin:0px;padding:0px;" class="container-fluid">
              <!-- inject:content -->
              
<div class="container-fluid">
  <div class="row">
    <div class="col-lg-3">
      <ul class="sidebar-nav second">
        <li><a href="/getting-started.html" class="alpha">Getting started with Telepat</a></li>
        <li class="border-top"><span>Developing apps using Telepat</span></li>
        <li class="small-margin"><a href="/data-fundamentals.html" class="beta">Data fundamentals</a></li>
        <li><a href="/user-management.html" class="gamma">User management</a></li>
        <li><a href="/js-tutorial.html" class="delta">App tutorial</a></li>
        <li class="border-top"><span>Telepat Cloud</span></li>
        <li class="small-margin"><a href="/cloud-dashboard.html" class="epsilon">Using the cloud dashboard</a></li>
        <li class="border-top"><span>Telepat Open Source</span></li>
        <li class="small-margin"><a href="/installation.html" class="zeta">Telepat install guide</a></li>
        <li><a href="/working-with-telepat.html" class="eta active">Working with Telepat</a>
          <ul>
            <li><a href="#api-basics" class="zeta">API basics</a></li>
            <li><a href="#authentication" class="zeta">Authentication</a></li>
            <li><a href="#device-registration" class="zeta">Device registration</a></li>
            <li><a href="#update-notifications" class="zeta">Update notifications</a></li>
            <li><a href="#configuring-push-notifications" class="zeta">Configuring push notifications</a></li>
          </ul>
        </li>
        <li><a href="/cli.html" class="theta">The Telepat CLI</a></li>
      </ul>
    </div>
    <div id="main-content" class="col-lg-9">
      <!-- inject:content:md -->
      <h1 id="working-with-telepat">Working with Telepat</h1>
<p><em>Note that the available SDKs handle all the communication with the Telepat server components, as described below, while exposing a simple, native way of working with objects. To enable push notification transports, you will need to <a href="#configuring-push-notifications">configure your credentials</a>.</em></p>
<h3 id="api-basics">API Basics</h3>
<p>You operate with Telepat by sending requests to the API endpoint. You can see a full list of supported methods, along with details about creating requests in the <a href="http://docs.telepat.io/api-docs.html">API reference</a>.</p>
<p>A success response from the API has the following structure:</p>
<pre><code class="lang-json">{
  &quot;status&quot;: ..., // Operation result status code - usually, 200 or 202 for success
  &quot;content&quot;: ... // Content can be a string, Object or Array, depending on the operation
}
</code></pre>
<p>An error response from the API has the following structure:</p>
<pre><code class="lang-json">{
  &quot;status&quot;: ..., // Operation error status code
  &quot;code&quot;: ..., // The code of the error encountered while processing operation
  &quot;message&quot;: ... // String describing encountered error
}
</code></pre>
<h3 id="authentication">Authentication</h3>
<p>Some routes require sending additional authentication header parameters in order to work. These parameters are:</p>
<table>
<thead>
<tr>
<th>Header name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X-BLGREQ-SIGN</td>
<td>SHA256 of a valid application API key</td>
</tr>
<tr>
<td>X-BLGREQ-APPID</td>
<td>The unique identifier of the application the request references</td>
</tr>
<tr>
<td>X-BLGREQ-UDID</td>
<td>The unique identifier of the device making the request. See <a href="#device-registration">device registration</a>.</td>
</tr>
<tr>
<td>Authentication</td>
<td>The JWT token identifying the currently logged in user or admin.</td>
</tr>
</tbody>
</table>
<h3 id="device-registration">Device registration</h3>
<p>To register a device with the Telepat backend, you need to follow a two step procedure:</p>
<ul>
<li>Call the <code>/device/register</code> API route. This gives the backend information on what your device is, and how they can exchange synchronization data. The body of the request should be an object with the following properties:</li>
</ul>
<table>
<thead>
<tr>
<th>Property name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>info</td>
<td>Contains various device information.</td>
</tr>
<tr>
<td>info.os</td>
<td>String representing the device operating system (optional).</td>
</tr>
<tr>
<td>info.version</td>
<td>String representing the device OS version (optional).</td>
</tr>
<tr>
<td>info.manufacturer</td>
<td>String representing the device manufacturer (optional).</td>
</tr>
<tr>
<td>info.model</td>
<td>String representing the device model (optional).</td>
</tr>
<tr>
<td>info.udid</td>
<td>Unique device identifier. If applicable, you can set this value instead of the X-BLGREQ-UDID header to make sure that devices that have previously registered get the same identifier back from Telepat.</td>
</tr>
<tr>
<td>persistent</td>
<td>Contains details about persistent connectivity channels (channels that are always active - like push notifications).</td>
</tr>
<tr>
<td>persistent.type</td>
<td>The type of persistent transport to use - one of &#39;ios&#39; or &#39;android&#39;.</td>
</tr>
<tr>
<td>persistent.token</td>
<td>The unique device token for the chosen transport - either the iOS PN token, or the GCM registration token.</td>
</tr>
<tr>
<td>persistent.active</td>
<td>Set this to 1 to enable the persistent transport.</td>
</tr>
</tbody>
</table>
<ul>
<li><p>If the current device is registering for the first time, and has no saved Telepat device identifier, set the <code>X-BLGREQ-UDID</code> header to the <code>TP_EMPTY_UDID</code> value</p>
</li>
<li><p>If the device can generate a unique identifier by itself, set that on the <code>info.udid</code> key. If not, leave that field empty. Note that this is different than the UDID received from Telepat that is used for the <code>X-BLGREQ-UDID</code> request header key.</p>
</li>
<li><p>The <code>/device/register</code> route can give two types of answers:</p>
<ul>
<li>If you&#39;ve sent a X-BLGREQ-UDID header along with the request, or if you&#39;ve specified another unique device identifier in the <code>info.udid</code> key of the body, Telepat will simply update the data on the existing device;</li>
<li>Else, if it&#39;s a new device, connecting to Telepat for the first time, a new device identifier will be generated and returned to the client. This should be used from now on to identify all requests made by this device.</li>
</ul>
</li>
<li><p>After registration, if the socket transport is required, you need to connect to the socket endpoint and then send a <code>bind_device</code> message to the server, with the following content:</p>
<pre><code class="lang-json">  {
    device_id: &#39;DEVICE-ID&#39;, // Set this to the UDID received from Telepat on first registration
    application_id: &#39;APPLICATION-ID&#39; // Set this to the id of the connected app
  }
</code></pre>
</li>
</ul>
<h3 id="update-notifications">Update notifications</h3>
<p>When objects that fall within one of a device&#39;s subscriptions are updated, the Telepat backend sends patches back to subscribers, containing deltas that describe the updates made. This allows clients to synchronize their local state with the global one at all times.</p>
<p>Depending on the transport channels that were set as active during device registration, you can receive the patches via push notifications (for mobile devices), or via websockets. If using websockets, patches will be sent together with the <code>message</code> event, so you need to create a listener for that specific event.</p>
<p>The structure of a patch object is:</p>
<table>
<thead>
<tr>
<th>Property name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Root container of the patches descriptor object</td>
</tr>
<tr>
<td>data.new[]</td>
<td>Array containing all individual patches for objects that are newly created</td>
</tr>
<tr>
<td>data.new[].object</td>
<td>The newly created object</td>
</tr>
<tr>
<td>data.new[].subscriptions</td>
<td>An array of device subscriptions that are affected by the current patch</td>
</tr>
<tr>
<td>data.new[].timestamp</td>
<td>Timestamp of when this patch was generated</td>
</tr>
<tr>
<td>data.new[].application_id</td>
<td>The application id of the new object</td>
</tr>
<tr>
<td>data.deleted[]</td>
<td>Array containing all individual patches for objects that are deleted</td>
</tr>
<tr>
<td>data.deleted[].object</td>
<td>The deleted object</td>
</tr>
<tr>
<td>data.deleted[].subscriptions</td>
<td>An array of device subscriptions that are affected by the current patch</td>
</tr>
<tr>
<td>data.deleted[].timestamp</td>
<td>Timestamp of when this patch was generated</td>
</tr>
<tr>
<td>data.deleted[].application_id</td>
<td>The application id of the deleted object</td>
</tr>
<tr>
<td>data.updated[]</td>
<td>Array containing all individual patches for objects that are updated</td>
</tr>
<tr>
<td>data.updated[].patch.op</td>
<td>The type of update operation applied. As of 0.4.1, this can only be &#39;replaced&#39;</td>
</tr>
<tr>
<td>data.updated[].patch.path</td>
<td>The path of the replaced value, in the <code>{model_name}/{object_id}/{key}</code> format.</td>
</tr>
<tr>
<td>data.updated[].patch.value</td>
<td>The new value of the property defined in <code>patch.path</code></td>
</tr>
<tr>
<td>data.updated[].subscriptions</td>
<td>An array of device subscriptions that are affected by the current patch</td>
</tr>
<tr>
<td>data.updated[].timestamp</td>
<td>Timestamp of when this patch was generated</td>
</tr>
<tr>
<td>data.updated[].application_id</td>
<td>The application id of the updated object</td>
</tr>
</tbody>
</table>
<p>Example of an update notification containing a newly created object:</p>
<pre><code class="lang-json">{
   &quot;data&quot;:{
      &quot;new&quot;:[
         {
            &quot;op&quot;:&quot;create&quot;,
            &quot;object&quot;:{
               &quot;image&quot;:null,
               &quot;title&quot;:&quot;text&quot;,
               &quot;user&quot;:null,
               &quot;user_id&quot;:&quot;d34d6fc1-bfb7-438d-bba6-8685fec199b2&quot;,
               &quot;type&quot;:&quot;model&quot;,
               &quot;context_id&quot;:&quot;e50089d5-a4fc-4997-9eae-af7b7147c8f8&quot;,
               &quot;application_id&quot;:&quot;5a42d57c-df7c-4a83-a921-7ab2f9f85ae7&quot;,
               &quot;id&quot;:&quot;5fedc735-c0ac-4f48-85c2-7338048820c3&quot;,
               &quot;created&quot;:1473175101,
               &quot;modified&quot;:1473175101
            },
            &quot;subscriptions&quot;:[
               &quot;blg:5a42d57c-df7c-4a83-a921-7ab2f9f85ae7:context:e50089d5-a4fc-4997-9eae-af7b7147c8f8:model&quot;
            ],
            &quot;application_id&quot;:&quot;5a42d57c-df7c-4a83-a921-7ab2f9f85ae7&quot;,
            &quot;timestamp&quot;:1473175082952686
         }
      ],
      &quot;updated&quot;:[],
      &quot;deleted&quot;:[]
   }
}
</code></pre>
<p>Example of an update notification containing data updates:</p>
<pre><code class="lang-json">{
   &quot;data&quot;:{
      &quot;new&quot;:[],
      &quot;updated&quot;:[
         {
            &quot;op&quot;:&quot;update&quot;,
            &quot;subscriptions&quot;:[
               &quot;blg:5a42d57c-df7c-4a83-a921-7ab2f9f85ae7:context:e50089d5-a4fc-4997-9eae-af7b7147c8f8:model&quot;
            ],
            &quot;application_id&quot;:&quot;5a42d57c-df7c-4a83-a921-7ab2f9f85ae7&quot;,
            &quot;timestamp&quot;:1473175260988508,
            &quot;patch&quot;:{
               &quot;op&quot;:&quot;replace&quot;,
               &quot;path&quot;:&quot;model/5fedc735-c0ac-4f48-85c2-7338048820c3/title&quot;,
               &quot;value&quot;:&quot;changed text&quot;
            }
         }
      ],
      &quot;deleted&quot;:[]
   }
}
</code></pre>
<p>Example of an update notification containing deleted objects:</p>
<pre><code class="lang-json">{
   &quot;data&quot;:{
      &quot;new&quot;:[],
      &quot;updated&quot;:[],
      &quot;deleted&quot;:[
         {
            &quot;op&quot;:&quot;delete&quot;,
            &quot;object&quot;:{
               &quot;application_id&quot;:&quot;5a42d57c-df7c-4a83-a921-7ab2f9f85ae7&quot;,
               &quot;context_id&quot;:&quot;e50089d5-a4fc-4997-9eae-af7b7147c8f8&quot;,
               &quot;created&quot;:1473175101,
               &quot;id&quot;:&quot;5fedc735-c0ac-4f48-85c2-7338048820c3&quot;,
               &quot;image&quot;:null,
               &quot;modified&quot;:1473175279,
               &quot;title&quot;:&quot;changed text&quot;,
               &quot;type&quot;:&quot;model&quot;,
               &quot;user&quot;:null,
               &quot;user_id&quot;:&quot;d34d6fc1-bfb7-438d-bba6-8685fec199b2&quot;
            },
            &quot;subscriptions&quot;:[
               &quot;blg:5a42d57c-df7c-4a83-a921-7ab2f9f85ae7:context:e50089d5-a4fc-4997-9eae-af7b7147c8f8:model&quot;
            ],
            &quot;application_id&quot;:&quot;5a42d57c-df7c-4a83-a921-7ab2f9f85ae7&quot;,
            &quot;timestamp&quot;:1473175313919102
         }
      ]
   }
}
</code></pre>
<h3 id="configuring-push-notifications">Configuring push notifications</h3>
<p>To activate persistent transports for mobile devices, Telepat needs to be configured to talk with push notification service providers, like Apple&#39;s APN servers and GCM servers. </p>
<p>Credentials are stored on each individual Telepat app, using the app object that can be accessed and modified by administrators. To do this:</p>
<ul>
<li>Set the <code>apn_pfx</code> key of the application object to a base-64 encoded ASCII string, created from the .p12 APN certificate, in which each character in the string is treated as a byte of binary data.</li>
<li>Set the <code>apn_passphrase</code> key on the application object to the password required in order to open the .p12 file.</li>
<li>Set the <code>gcm_api_key</code> key on the application object to the API key for the GCM transport.</li>
</ul>

      <!-- endinject -->
    </div>
  </div>
</div>
              <!-- endinject -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- build:js(./app/) scripts/vendor.min.js-->
  <!-- endbuild-->
  <!-- build:js scripts/plugins.min.js-->
  <!-- endbuild-->
  <!-- build:js(.tmp) scripts/main.min.js-->
  <!-- endbuild-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.17/require.min.js"></script>
  <!-- script(src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js")-->
  <script src="/scripts/require.config.js"></script>
  <script src="scripts/menu-highlight.js"></script>
  <script src="scripts/github.js"></script>
  <script src="scripts/image-zoom.js"></script><!-- inject:scripts -->
  
  <!-- endinject -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-84082598-2', 'auto');
    ga('send', 'pageview');
  </script>
  <script>
    window.intercomSettings = {
      app_id: "hdsacrdm"
    };
  </script>
  <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/hdsacrdm';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>
</body>